{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.3", "generated_at": "2025-07-08T06:35:51.032766Z", "invocation_id": "791a706e-fe1a-4d48-95c0-c481f8c6d2b2", "invocation_started_at": "2025-07-08T06:35:38.954407Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-08T06:35:46.832497Z", "completed_at": "2025-07-08T06:35:46.854281Z"}, {"name": "execute", "started_at": "2025-07-08T06:35:46.855571Z", "completed_at": "2025-07-08T06:35:51.018898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.190359115600586, "adapter_response": {"_message": "CREATE TABLE (5.0 rows, 158.1 KiB processed)", "code": "CREATE TABLE", "rows_affected": 5, "bytes_processed": 161899, "bytes_billed": 20971520, "location": "US", "project_id": "gasag-465208", "job_id": "3bcb3ba1-f33c-4e5b-8166-8e5b209df294", "slot_ms": 35091}, "message": "CREATE TABLE (5.0 rows, 158.1 KiB processed)", "failures": null, "unique_id": "model.gasag.kraftwerke_metrics", "compiled": true, "compiled_code": "WITH staging_data AS (\n    SELECT * FROM `gasag-465208`.`analysis`.`stg_kraftwerksdaten`\n),\n\n-- Daily aggregations first\ndaily_metrics AS (\n    SELECT\n        Kraftwerk,\n        DATE(Timestamp) as date,\n        -- Daily total load (sum of all Leistung for the day)\n        SUM(leistung) AS daily_total_load,\n        -- Daily average load (average of all Leistung for the day)\n        AVG(leistung) AS daily_avg_load,\n        -- Count of peak loads for the day\n        COUNT(CASE WHEN is_peak_load THEN 1 END) AS daily_peak_loads,\n        -- Count of decreasing meter readings for the day\n        COUNT(CASE WHEN is_decreasing_zaehlerstand THEN 1 END) AS daily_decreasing_readings,\n        -- Total hours with data for the day\n        COUNT(*) AS daily_total_hours\n    FROM staging_data\n    WHERE NOT is_last_day\n    GROUP BY Kraftwerk, DATE(Timestamp)\n),\n\n-- Historical metrics (averages across all days)\nhistorical_metrics AS (\n    SELECT\n        s.Kraftwerk,\n        -- Durchschnittliche Grundlast (average base load per hour, excluding NULLs)\n        AVG(CASE WHEN NOT s.is_peak_load THEN s.leistung END) AS durchschnittliche_grundlast,\n\n        -- Durchschnittliche Spitzenlast (average peak load per hour, excluding NULLs)\n        AVG(CASE WHEN s.is_peak_load THEN s.leistung END) AS durchschnittliche_spitzenlast,\n\n        -- Durchschnittliche Gesamtlast pro Tag (average daily total load)\n        AVG(d.daily_total_load) AS durchschnittliche_gesamtlast_pro_tag,\n\n        -- Quote an Spitzenlasten (percentage of peak loads across all days)\n        SUM(d.daily_peak_loads) * 100.0 / SUM(d.daily_total_hours) AS quote_spitzenlasten_prozent,\n\n        -- Quote an R\u00fcckl\u00e4ufigen Z\u00e4hlerst\u00e4nden (percentage of decreasing meter readings across all days)\n        SUM(d.daily_decreasing_readings) * 100.0 / SUM(d.daily_total_hours) AS quote_ruecklaeufige_zaehlerstaende_prozent\n\n    FROM staging_data s\n    LEFT JOIN daily_metrics d ON s.Kraftwerk = d.Kraftwerk AND DATE(s.Timestamp) = d.date\n    WHERE NOT s.is_last_day\n    GROUP BY s.Kraftwerk\n),\n\n-- Expected performance from today_power_data (sum of actual + predicted)\ntoday_expected AS (\n    SELECT\n        Kraftwerk,\n        -- Sum all values (Leistung + Prognose) for the day\n        SUM(COALESCE(Leistung, 0) + COALESCE(Prognose, 0)) AS erwartete_leistung\n    FROM `gasag-465208`.`analysis`.`today_power_data`\n    GROUP BY Kraftwerk\n)\n\nSELECT\n    h.Kraftwerk,\n    h.durchschnittliche_grundlast,\n    h.durchschnittliche_spitzenlast,\n    h.durchschnittliche_gesamtlast_pro_tag,\n    h.quote_spitzenlasten_prozent,\n    h.quote_ruecklaeufige_zaehlerstaende_prozent,\n    t.erwartete_leistung\nFROM historical_metrics h\nLEFT JOIN today_expected t ON h.Kraftwerk = t.Kraftwerk", "relation_name": "`gasag-465208`.`analysis`.`kraftwerke_metrics`", "batch_results": null}], "elapsed_time": 6.799248456954956, "args": {"source_freshness_run_project_hooks": true, "favor_state": false, "use_fast_test_edges": false, "log_path": "/home/anton/code/gasag/dbt_gasag/logs", "printer_width": 80, "vars": {}, "write_json": true, "exclude": [], "log_format": "default", "send_anonymous_usage_stats": true, "static_parser": true, "version_check": true, "indirect_selection": "eager", "log_level_file": "debug", "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "defer": false, "show_all_deprecations": false, "strict_mode": false, "upload_to_artifacts_ingest_api": false, "partial_parse_file_diff": true, "print": true, "state_modified_compare_vars": false, "log_format_file": "debug", "invocation_command": "dbt run --select kraftwerke_metrics", "require_batched_execution_for_custom_microbatch_strategy": false, "select": ["kraftwerke_metrics"], "log_file_max_bytes": 10485760, "skip_nodes_if_on_run_start_fails": false, "validate_macro_args": false, "cache_selected_only": false, "macro_debugging": false, "project_dir": "/home/anton/code/gasag/dbt_gasag", "require_resource_names_without_spaces": true, "require_nested_cumulative_type_params": false, "use_colors": true, "log_level": "info", "warn_error_options": {"error": [], "warn": [], "silence": []}, "quiet": false, "require_all_warnings_handled_by_warn_error": false, "empty": false, "use_colors_file": true, "show_resource_report": false, "which": "run", "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "profiles_dir": "/home/anton/.dbt", "state_modified_compare_more_unrendered_values": false}}